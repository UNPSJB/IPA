{% extends 'index2.html' %}
{% load actionButton %}
{% load render_table from django_tables2 %}

{% block wrapper %}
<div class="ui grid"> 
	<div class="row header-content">
		<div class="six wide column">
			{% if filter %}
				<button class="ui icon button filter">
						<i class="filter icon"></i>
				</button>				
			{% endif %}
		</div>
		<div class="four wide column">
			<h1 class="ui center aligned header blue "> {% block titulo %} Listado {% endblock %} </h1>
		</div>
		<div class="six wide column">
			<button class="ui icon right floated blue button" onclick="window.location.href='{% block url_nuevo %} alta {% endblock %}'">
				<i class="plus icon"></i>
				{% block boton_nuevo %} Nuevo {% endblock %} 
			</button>
		</div>
	</div>
	<div class="row lista">
		{% render_table table %}
	</div>
</div>

<div class="ui modal" id="informacion-modal">
	<div class="ui center aligned header" id="modal-header"></div>
	<div class="content">
		{% block contenido_informacion_modal %} {% endblock %}
	</div>
	<div class="actions">
		<div class="ui cancel blue button">Cerrar</div>
	</div>
</div>

<div class="ui small modal" id="eliminar-modal">
	<div class="ui center aligned header">Â¡Cuidado!</div>
	<div class="content">
		{% block mensaje_eliminar_modal %} {% endblock %}
	</div>
	<div class="actions">
		<div class="ui positive button">Eliminar</div>
		<div class="ui negative button">Cancelar</div>
	</div>
</div> 


<div class="ui modal" id="filter-modal">
	<div class="ui center aligned header" id="modal-header">Filtros</div>
	<div class="content">
		<form action="" method="get" class="ui form">
			{% block filter-form %}
			{{ filter.form }}					
			{% endblock %}
			 
			<button class="ui positive right button">Filtrar</button>
			<button class="ui negative right button">Cancelar</button>
		</form>
	</div>
</div>

{% endblock %}

{% block customPageJs %}

	// using jQuery
	function getCookie(name) {
		var cookieValue = null;
		if (document.cookie && document.cookie != '') {
			var cookies = document.cookie.split(';');
			for (var i = 0; i < cookies.length; i++) {
				var cookie = jQuery.trim(cookies[i]);
				// Does this cookie string begin with the name we want?
				if (cookie.substring(0, name.length + 1) == (name + '=')) {
					cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
					break;
				}
			}
		}
		return cookieValue;
	}

	var csrftoken = getCookie('csrftoken');
	function csrfSafeMethod(method) {
		// these HTTP methods do not require CSRF protection
		return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
    }
	$.ajaxSetup({
		beforeSend: function(xhr, settings) {
			if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
				xhr.setRequestHeader("X-CSRFToken", csrftoken);
			}
		}
    });
    
	$(".ui.button.detalle").click(function(){
		{% block comportamiento_click_detalle %}
		  
		{% endblock comportamiento_click_detalle %}
	})

	$(".ui.button.eliminar").click(function(){
		{% block comportamiento_click_eliminar %}
		  
		{% endblock comportamiento_click_eliminar %}
	})

	$(".ui.button.filter").click(function(){
		 $("#filter-modal").modal('show')
	})

{% endblock %}
