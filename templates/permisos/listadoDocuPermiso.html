{% extends 'index2.html' %}

{% load staticfiles %}
{% load contextMenu %}



{% block wrapper %}
    
    {% renderContextMenu %}
    
	<div class="ui grid"> 
		<div class="row header-content">
			<div class="ui cards">
				{% for documento in documentos %}
					<div class="card">
						<div class="image">
							<img src="{% static documento.thumbnail %}">
						</div>
						{%if not documento.tipo.protegido%}
							<div class="extra">Visado<i class="circle icon" style="color:
							{%if documento.visado%}green{%else%}red{%endif%}"></i></div>
						{% endif %}
						<div class="content">
							<a href="/archivos/{{documento.archivo.url}}" id="tipo-{{documento.id}}" class="header">{{documento.tipo.nombre}}</a>
							<div class="meta">
								<span class="date">{{documento.fecha}}</span>
							</div>
							<div class="description">{{documento.descripcion}}</div>
						</div>
						<div class="extra content">
							<div class="ui basic buttons">
								{% if permiso.estado.tipo == 1 or permiso.estado.tipo == 2%}
									<a class="ui button" href="{% url 'permisos:visarDocumentoSolicitud' permiso.id documento.id %}">VISAR</a>
								{% endif %}
								{% if permiso.estado.tipo < 3 or documento.tipo.protegido%}
									<a class="ui button" href="{% url 'documentos:modificar' documento.id permiso.id%}">Modificar</a>
								{% endif %}
									<a class="ui button eliminar" id="eliminar-{{documento.id}}">Eliminar</a>
							</div>
						</div>
					</div>
				{% endfor%}
			</div>
		</div>
	</div>

	<div class="ui small modal" id="eliminar-modal">
		<div class="ui center aligned header">¡Cuidado!</div>
		<div class="content">
			¿Desea seguro de eliminar el documento "<span id="eliminar-modal-tipo"></span>" del permiso?
		</div>
		<div class="actions">
			<div class="ui positive button">Eliminar</div>
			<div class="ui negative button">Cancelar</div>
		</div>
	</div> 

{% endblock %}

{% block customPageJs %}
    
	$(".ui.button.eliminar").click(function(datos){
		var splitted_data = this.id.split('-');
		console.log(splitted_data)
		console.log(splitted_data)
		console.log($('#tipo-'+splitted_data[1]).html())
		console.log($('#tipo-'+splitted_data[1]).html())
		var tipo = $('#tipo-'+splitted_data[1]).html()
		$("#eliminar-modal-tipo").html(tipo)
		$('#eliminar-modal').modal({
			onApprove : function() {
				//mandar a borrar

			}
		}).modal('show');
	})


{% endblock %}


 {% block pageStaticJs %}
	<script type="text/javascript" src="{% static 'page/js/index.js'%}"></script>
{% endblock %}
